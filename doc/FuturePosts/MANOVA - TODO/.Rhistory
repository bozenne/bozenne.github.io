source('~/GitHub/consultationNRU/download/MANOVA - TODO/glsINr.R')
####
library(nlme)
library(data.table)
library(lava)
#### 1- simulation ####
m <- lvm(list(Y1~0.25*Gender+0.05*Age+eta,
Y2~1.3*eta,
Y3~0.1*eta,
Y4~0.8*eta,
Y5~0.9*eta,
Y6~eta))
latent(m) <- ~eta
regression(m) <- eta~Gender+Age
distribution(m,~Gender) <- binomial.lvm()
distribution(m,~Y1+Y2+Y3+Y4+Y5+Y6) <- gaussian.lvm(sd = 4)
dt <- data.table(sim(m,2e2))
dt[, eta:= NULL]
dt[, Id := as.character(1:.N)]
## data
dtL <- melt(dt, id.vars = c("Gender","Age","Id"), variable.name = "region", value.name = "BPnd")
#### 2- implicit modelisation: manova ####
# (we don't describe the covariance matrix here)
m.manova <- manova(cbind(Y1,Y2,Y3,Y4,Y5,Y6) ~ Gender + Age,data = dt)
summary(m.manova)
m.gls <- gls(BPnd ~ Gender + Age,
correlation = corSymm(form = ~1|Id),
weights = varIdent(form = ~1|region),
data = dtL)
summary(m.gls)
lm(manova)
lm(m.manova)
